# 專案需求分析：基於 Word 範本之 AI 驅動自動化測試與報告生成系統

## 1. 專案背景與目標
[cite_start]為了提升「臺灣史檔案資源系統」[cite: 78] 測試驗收的效率，本專案旨在建立一套自動化測試與報告生成流程。
核心目標為**「零學習成本」**：讓 SA（系統分析師）與 PM（專案經理）能維持原本使用 Word 撰寫測試計畫的習慣，無需學習撰寫程式碼或複雜的變數標籤，即可透過 AI Agent 自動執行網頁測試，並一鍵產出包含真實截圖的《系統測試報告》。

## 2. 角色與職責定義 (Role Definition)
* **SA / PM (非工程人員)**：
    * **職責**：維護測試劇本與預期結果。
    * **操作**：直接在 `test.docx` 的表格中，用自然語言（白話文）撰寫「操作步驟」。
    * **唯一標記**：在需要系統補上圖片的儲存格內，打上特定的純文字標記（例如：`[需截圖]`）。
* **AI Agent / 自動化腳本 (系統端)**：
    * **職責**：執行測試、抓取畫面、合成報告。
    * **操作**：讀取 Word 檔提取步驟 -> 控制瀏覽器執行動作 -> 擷取畫面 -> 將截圖取代 Word 中的 `[需截圖]` 標記並另存新檔。

## 3. 系統核心流程 (Core Workflow)
1.  [cite_start]**Input (文件讀取)**：腳本解析 SA/PM 提供的 `.docx` 檔案，定位出「個案測試項目」[cite: 62] 的表格，並粹取出「測試項目」、「操作步驟」等欄位內容。
2.  **Execution (自動化執行)**：將提取出的自然語言步驟，轉譯為自動化測試指令（透過 Playwright 或 Selenium 控制瀏覽器），依序執行點擊、輸入、檔案上傳等動作。
3.  **Capture (截圖留存)**：在每個關鍵預期結果確認後，系統自動進行網頁截圖，並暫存於本機端。
4.  **Output (報告生成)**：腳本再次開啟原本的 `.docx` 檔案，尋找所有 `[需截圖]` 字串，將其替換為對應的截圖圖檔，最後匯出成完整的 `系統測試報告_完成版.docx`。

## 4. 功能需求清單 (Functional Requirements)
### 功能一：Word 表格解析模組
* [cite_start]需能讀取 `.docx` 檔案中特定的測試表格（如「前台介面改版」[cite: 64][cite_start]、「資料匯入」[cite: 69]等）。
* 精準提取表格內的「操作步驟」字串，建立待執行的任務清單。

### 功能二：AI 代理與網頁自動化模組
* [cite_start]透過 Antigravity Agent 將自然語言步驟（如「點選主選單→全宗瀏覽」[cite: 65]）映射至實際的網頁 DOM 元素操作。
* [cite_start]支援各類型網頁互動：點擊、文字輸入、等待載入、檔案上傳（如匯入清單測試 [cite: 70]）。
* 具備錯誤捕捉機制：若網頁無預期回應，需紀錄失敗狀態。

### 功能三：Word 報告組裝模組
* 掃描 Word 文件內容，精準定位自訂標記（如 `[需截圖]`）。
* 支援將本機圖片直接插入 Word 文件中的指定位置，並自動調整圖片長寬比例以符合表格大小，避免版面跑版。
* [cite_start]保留原 Word 檔的所有樣式、標題（如「壹、 前言」[cite: 10]）與版面設定，另存新檔。

## 5. 技術選型建議 (Tech Stack)
* **程式語言**：Python
* **Word 文件處理**：`python-docx` (用於讀取表格文字與替換標記/插入圖片)。
* **網頁自動化框架**：`Playwright` (推薦，速度快且支援非同步) 或 `Selenium`。
* **AI Agent 協作**：Antigravity IDE 內建模型 (協助將自然語言轉化為 Playwright 操作腳本)。

## 6. 概念驗證 (POC) 實作步驟規劃
為確保流程可行，建議第一階段先完成以下最小可行性驗證：
1.  [cite_start]**Step 1**：準備一份精簡版的 Word 測試範本，僅包含一項測試（例如：前台檢索的「關鍵字查詢」[cite: 67]），並寫上 `[需截圖]`。
2.  **Step 2**：撰寫 Python 腳本，成功讀取該 Word 表格內容並印出在終端機。
3.  **Step 3**：利用 Playwright 寫死一段前往查詢頁面並截圖存檔的腳本。
4.  **Step 4**：撰寫 Python 腳本，將剛剛的截圖成功塞回 Word 的 `[需截圖]` 位置並另存。